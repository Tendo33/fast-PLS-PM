# ============================================================================
# PLS-PM 分析配置文件示例
# ============================================================================
# 
# 本文件是配置文件模板，包含详细的字段说明和使用示例
# 使用步骤：
#   1. 复制此文件为 config.yaml：cp config.example.yaml config.yaml
#   2. 根据你的数据文件修改 config.yaml 中的配置
#   3. 运行分析：uv run python analyze_pls.py
#
# ============================================================================

# ----------------------------------------------------------------------------
# 第一部分：数据文件配置
# ----------------------------------------------------------------------------
# 说明：指定你的 Excel 数据文件位置和格式

data:
  # Excel 文件路径（必需）
  # - 可以是相对路径（相对于项目根目录）或绝对路径
  # - 支持 .xlsx 和 .xls 格式
  # 示例：
  #   相对路径："data/my_experiment.xlsx"
  #   绝对路径："/Users/username/Documents/experiment_data.xlsx"
  file_path: "data/PLS-剂量实验.xlsx"
  
  # 表头行设置（必需）
  # - null：表示文件没有表头，第一行就是数据
  # - 0：表示第一行（索引0）是表头
  # - 1：表示第二行（索引1）是表头
  # 提示：打开你的 Excel 文件，如果第一行是"样本1、样本2..."这样的数据，设为 null
  #       如果第一行是"处理剂量、产蛋率..."这样的标题，设为 0
  header: null
  
  # 数据起始行（必需）
  # - 从第几行开始读取实际数据（0-indexed，从0开始计数）
  # - 如果 header 是 null，通常设为 1（跳过第0行的分类说明）
  # - 如果 header 是 0，数据会自动从第1行开始
  # 示例：
  #   文件结构是：第0行分类说明，第1行开始是数据 → 设为 1
  #   文件结构是：第0行表头，第1行开始是数据 → 设为 1
  data_start_row: 1

# ----------------------------------------------------------------------------
# 第二部分：列映射配置
# ----------------------------------------------------------------------------
# 说明：将 Excel 中的列（按位置）映射为分析中使用的变量名
# 
# 重要概念：
#   - Excel 列从左到右依次是：A列=索引0，B列=索引1，C列=索引2...
#   - 左侧数字是 Excel 列的索引号（从0开始）
#   - 右侧字符串是你为这一列起的变量名（自定义，但要有意义）
#   - 只需映射你分析中要用到的列，其他列会被忽略
#
# 如何确定列索引：
#   1. 打开你的 Excel 文件
#   2. 数一下你要的数据在第几列（从左边第1列开始数）
#   3. 列索引 = 列序号 - 1（因为索引从0开始）
#      例如：Excel 的第1列(A列) → 索引是 0
#            Excel 的第2列(B列) → 索引是 1
#            Excel 的第5列(E列) → 索引是 4
#
# 示例场景：
#   假设你的 Excel 文件是这样的：
#   | A列 | B列 | C列 | D列 | E列 |
#   |-----|-----|-----|-----|-----|
#   | 剂量 | 指标1 | 指标2 | 指标3 | 其他 |
#   
#   那么配置应该是：
#   column_mapping:
#     0: "dose"        # A列：剂量
#     1: "indicator1"  # B列：指标1
#     2: "indicator2"  # C列：指标2
#     3: "indicator3"  # D列：指标3
#     # 不需要 E列（其他），就不写

column_mapping:
  # 格式：列索引: "变量名"
  # 变量名规则：
  #   - 只能包含字母、数字、下划线
  #   - 不能以数字开头
  #   - 建议使用有意义的英文名称
  
  1: "UroA_meas"       # 第2列(B列)：Urolithin A 剂量测量值
  2: "Egg_1"           # 第3列(C列)：产蛋性能指标1
  3: "Egg_2"           # 第4列(D列)：产蛋性能指标2
  4: "LiverW_1"        # 第5列(E列)：肝脏重量指标1
  5: "LiverW_2"        # 第6列(F列)：肝脏重量指标2
  6: "FatW_1"          # 第7列(G列)：腹脂重量指标1
  7: "FatW_2"          # 第8列(H列)：腹脂重量指标2
  8: "SerumLip_1"      # 第9列(I列)：血清脂质指标1
  9: "SerumLip_2"      # 第10列(J列)：血清脂质指标2
  10: "SerumLip_3"     # 第11列(K列)：血清脂质指标3
  11: "LiverLip_1"     # 第12列(L列)：肝脏脂质指标1
  12: "LiverLip_2"     # 第13列(M列)：肝脏脂质指标2
  13: "LiverLip_3"     # 第14列(N列)：肝脏脂质指标3
  14: "LiverInj_meas"  # 第15列(O列)：肝损伤测量值

# ----------------------------------------------------------------------------
# 第三部分：潜变量定义
# ----------------------------------------------------------------------------
# 说明：定义你的研究模型中的"概念"或"构念"
#
# 什么是潜变量（Latent Variable）？
#   - 潜变量是无法直接测量的抽象概念，需要通过多个可观测指标来反映
#   - 例如："健康状况"是潜变量，通过"血压"、"心率"、"体重"等指标来测量
#   - 在本例中："产蛋性能"是潜变量，通过"产蛋率"、"蛋重"等指标来测量
#
# 每个潜变量包含三个部分：
#   1. name（名称）：潜变量的名字，自定义但要有意义
#   2. mode（测量模式）：指标与潜变量的关系类型
#   3. indicators（观测指标）：用来测量这个潜变量的具体指标列表

latent_variables:
  # ----------------
  # 潜变量 1：UroA（尿石素A剂量）
  # ----------------
  - name: "UroA"
    # 潜变量名称
    # - 这是你在路径模型中引用这个变量时使用的名字
    # - 建议使用简洁、有意义的英文名
    
    mode: "A"
    # 测量模式（Mode）
    # 两种选择：
    #   "A" = 反映性模式（Reflective）
    #     - 指标是潜变量的"反映"或"结果"
    #     - 潜变量影响指标
    #     - 例如："智力"影响"数学成绩"、"语文成绩"
    #     - 最常用，90%的情况选这个
    #   
    #   "B" = 形成性模式（Formative）
    #     - 指标"形成"或"构成"潜变量
    #     - 指标影响潜变量
    #     - 例如："收入"+"资产"+"教育"形成"社会经济地位"
    #     - 较少用
    #
    # 如何选择？
    #   - 如果不确定，选 "A"
    #   - 如果指标之间应该高度相关（测量同一个东西），选 "A"
    #   - 如果指标之间不一定相关（组合成一个概念），选 "B"
    
    indicators:
      # 观测指标列表
      # - 列出所有用来测量这个潜变量的指标
      # - 这里的名称必须与上面 column_mapping 中定义的变量名完全一致
      # - 可以有1个或多个指标
      # - 格式：每行一个指标，以 - 开头
      - "UroA_meas"
  
  # ----------------
  # 潜变量 2：Egg（产蛋性能）
  # ----------------
  - name: "Egg"
    mode: "A"
    indicators:
      # 这个潜变量用2个指标来测量
      # 例如：产蛋率和平均蛋重
      - "Egg_1"
      - "Egg_2"
  
  # ----------------
  # 潜变量 3：LiverW（肝脏重量指数）
  # ----------------
  - name: "LiverW"
    mode: "A"
    indicators:
      - "LiverW_1"
      - "LiverW_2"
  
  # ----------------
  # 潜变量 4：FatW（腹脂重量）
  # ----------------
  - name: "FatW"
    mode: "A"
    indicators:
      - "FatW_1"
      - "FatW_2"
  
  # ----------------
  # 潜变量 5：SerumLip（血清脂质）
  # ----------------
  - name: "SerumLip"
    mode: "A"
    indicators:
      # 这个潜变量用3个指标来测量
      # 例如：总胆固醇、甘油三酯、低密度脂蛋白
      - "SerumLip_1"
      - "SerumLip_2"
      - "SerumLip_3"
  
  # ----------------
  # 潜变量 6：LiverLip（肝脏脂质）
  # ----------------
  - name: "LiverLip"
    mode: "A"
    indicators:
      - "LiverLip_1"
      - "LiverLip_2"
      - "LiverLip_3"
  
  # ----------------
  # 潜变量 7：LiverInj（肝损伤）
  # ----------------
  - name: "LiverInj"
    mode: "A"
    indicators:
      - "LiverInj_meas"

# ----------------------------------------------------------------------------
# 第四部分：路径模型定义
# ----------------------------------------------------------------------------
# 说明：定义潜变量之间的因果关系（谁影响谁）
#
# 什么是路径模型？
#   - 路径模型描述变量之间的假设关系
#   - 每条路径表示：自变量 → 因变量
#   - 例如："剂量 → 健康指标" 表示我们假设剂量会影响健康指标
#
# 格式说明：
#   - 每行一个路径，格式：- ["源变量", "目标变量"]
#   - 源变量（第一个）：影响别人的变量（自变量、预测变量）
#   - 目标变量（第二个）：被影响的变量（因变量、结果变量）
#   - 变量名必须是上面 latent_variables 中定义的 name
#
# 示例：
#   - ["Treatment", "Outcome"]  # 表示：Treatment 影响 Outcome
#   - ["Outcome", "Treatment"]  # 表示：Outcome 影响 Treatment（相反方向）
#
# 注意：
#   - 路径是有方向的！["A", "B"] 和 ["B", "A"] 完全不同
#   - 通常从自变量（如：处理、剂量）指向因变量（如：结果、指标）
#   - 可以有多条路径（多个影响关系）
#   - 可以有间接路径（如：A→B, B→C，形成 A→B→C 的链条）

paths:
  # 本例的研究假设：UroA（尿石素A剂量）影响所有其他生理指标
  
  - ["UroA", "Egg"]
    # 路径1：UroA 影响 产蛋性能
    # 含义：我们假设尿石素A剂量会影响蛋鸡的产蛋性能
  
  - ["UroA", "LiverW"]
    # 路径2：UroA 影响 肝脏重量指数
  
  - ["UroA", "FatW"]
    # 路径3：UroA 影响 腹脂重量
  
  - ["UroA", "SerumLip"]
    # 路径4：UroA 影响 血清脂质
  
  - ["UroA", "LiverLip"]
    # 路径5：UroA 影响 肝脏脂质
  
  - ["UroA", "LiverInj"]
    # 路径6：UroA 影响 肝损伤
  
  # 更复杂的模型示例（本例未使用）：
  # - ["UroA", "LiverLip"]       # UroA 直接影响 肝脏脂质
  # - ["LiverLip", "LiverInj"]   # 肝脏脂质 影响 肝损伤
  # 这样就形成了：UroA → LiverLip → LiverInj 的中介路径

# ----------------------------------------------------------------------------
# 第五部分：输出配置
# ----------------------------------------------------------------------------
# 说明：设置分析结果输出文件的名称和位置

output:
  # PLS-PM 分析报告文件名（必需）
  # - 成功运行 PLS-PM 分析后，结果会保存到这个文件
  # - 文件格式是 Markdown (.md)
  # - 可以用任何文本编辑器或 Markdown 阅读器打开
  # - 建议文件名包含日期或实验名称，方便区分
  # 示例：
  #   "pls_pm_report.md"
  #   "experiment_2024_results.md"
  #   "dose_response_analysis.md"
  report_file: "output/pls_pm_report.md"
  
  # SEM 分析报告文件名（可选）
  # - 如果 PLS-PM 分析失败，程序会尝试 SEM 方法
  # - SEM 结果会保存到这个文件
  # - 通常不需要修改
  sem_report_file: "output/sem_report.md"

# ============================================================================
# 配置完成！
# ============================================================================
#
# 下一步操作：
#   1. 保存此文件为 config.yaml
#   2. 确保你的 Excel 数据文件路径正确
#   3. 运行命令：uv run python analyze_pls.py
#   4. 等待分析完成，查看生成的报告文件
#
# 常见问题：
#   Q: 如何知道我的 Excel 列索引？
#   A: 在 Excel 中打开文件，从左往右数列号，第1列是索引0，第2列是索引1...
#
#   Q: 我的指标只有1个，可以只写1个 indicator 吗？
#   A: 可以！一个潜变量至少要有1个指标，可以有多个。
#
#   Q: 路径方向搞反了会怎样？
#   A: 结果会完全不同！一定要确保是"自变量指向因变量"。
#
#   Q: 怎么验证配置是否正确？
#   A: 运行程序，如果报错会提示哪里配置有问题。建议先用示例配置测试。
#
# ============================================================================
